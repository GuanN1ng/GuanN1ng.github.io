---
layout: post
title:  "Lists,Stacks,Queues"
date:   2021-06-02 19:26:45
categories: 
- MySQL
---

读写分离的目标是分摊主库的压力，一般有两种架构：第一种，由客户端主动做负载均衡，客户端持有所有的数据库连接信息；第二种是在MySQL和客户端之间
有一个中间代理层proxy，客户端只连接proxy，由proxy根据请求类型决定请求的分发路由。

读写分离是由主从架构支持的，不可避免出现主从延迟，当主库刚执行完一个事务更新，查询从库时可能读到事务更新前的状态。

优化方案

* 强制走主库
    
    对于实时性要求高，即必须拿到最新结果的请求，强制其走主库查询。而对实时性要求不高的请求，可以走从库。此方案的最坏结果为放弃读写分离的扩展性。

* semi-sync replication半同步复制

    一主多从时，当查询落在非响应ack的从库上，仍会出现读到事务上个状态的可能。


    